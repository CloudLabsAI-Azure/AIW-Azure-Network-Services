
# Exercise 5 : Provision & Configure Azure Firewall & Application Gateway

### Overview


## Task 1: Provision Azure Firewall

In this task, you will be creating Azure Firewall. Azure Firewall is a cloud native network security service. It offers fully stateful network and application level traffic filtering for VNet resources, with built-in high availability and cloud scalability delivered as a service. You can protect your VNets by filtering outbound, inbound, spoke-to-spoke, VPN, and ExpressRoute traffic.

1. On the Azure Portal **Home** page, search for **Azure Firewall** and select it.

    ![firewall](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/firewall.png?raw=true)
    
2. Click on **Create firewall** under **Firewalls** page.

    ![create firewall](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/createfirewall.png?raw=true)
    
3. Under the **Basics** tab of **Create a firewall** page, enter the below information:

     - Subscriptio: Choose your **Subscription** from drop-down list.

     - Resource group: Select **hands-on-lab-<inject key="DeploymentID" enableCopy="false"/>** from the drop-down list

     - Name: Enter **AzFW-<inject key="DeploymentID" enableCopy="true"/>**

     - Region: Choose **East US**

     - Firewall management: **Use a Firewall Policy to manage this firewall**

       ![firewall](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/fw.png?raw=true)

     - Firewall policy: Click on **Add new(1)**, enter Policy name as **AFPolicy(2)** and Region as **East US(3)**, then click on **Yes(4)**

        ![FWP](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/FWP.png?raw=true)
        
     - Choose Virtual Network: **Use existing** and select Virtual network name as **NSVnet-<inject key="DeploymentID" enableCopy="false"/>** from drop-down list.

     - Public IP Address: Click on **Add new(1)**, enter Name as **FirewallIp(2)** and click on **Ok(3)**, then select **Review + Create**

         ![create](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/FWi.png?raw=true)

4. Review the configuration and select **Create**.

    ![create](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/ip1.png?raw=true)
    
5. After creating the firewall successfully, click on **Home** to navigate to home page of Azure Portal.

    ![home](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/home2.png?raw=true)


## Task 2: Provision Application Gateway with WAF


1. On the Azure Portal **Home** page, search for **Application Gateways** and select it.

     ![application](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/application.png?raw=true)
     
2. Click on **Create application gateway** from **Application gateway** page.

     ![app](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/cag.png?raw=true)
     
3. On the **Basics** tab of **Create application gateway** page, enter the follow the below instructions:

      - Subscription: Select your **Subscription** from frop-down list

      - Resource group: Select **Hands-on-lab-<inject key="DeploymentID" enableCopy="false"/>**

      - Application gateway name: Enter **Appgateway-<inject key="DeploymentID" enableCopy="true"/>**

      - Region: **East US**

      - Tier: **WAF V2**

      - Virtual network: Select **NSVnet-<inject key="DeploymentID" enableCopy="false"/>**

      - Subnet: Select **default** subnet from drop-down list.

      - Select **Next : Frontends**

        ![cp](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/appgate.png?raw=true)
        
4. Under the **Frontends** tab, enter the following details:

     - Frontend IP address type: **Public**

     - Public IP address: Click on **Add new**, enter Name as **AGIP-<inject key="DeploymentID" enableCopy="true"/>** and click on **Ok**

     - Select **Backends**

        ![fe](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/frontend.png?raw=true)
        
5. Under **Backends** page, select **Add a backend pool**

      ![bp](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/bp.png?raw=true)
      
6. Under **Add a backend pool** page, enter the below steps:

      - Name: Enter **BackendPool**

      - Add backend pool without targets: Select **No**

      - Target type: Select **Virtual Machine** from drop-down

      - Taget:Select **VM1-<inject key="DeploymentID" enableCopy="false"/>-nic** from down-down list.

      - Target type: Again select **Virtual Machine** from drop-down

      - Taget:Select **VM1-<inject key="DeploymentID" enableCopy="false"/>-nic** from down-down list.
      
      - Select **Add**

        ![pool](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/di.png?raw=true)
        
7. Now, select **Next : Configuration** under **Create application gateway**.

8. Under **Configuration**, select **Add a routing rule**.

     ![rule](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/rr.png?raw=true)
     
9. Inside **Add a routing rule** page, enter the below information:

     - Name: **RoutingRule**

     -Listener name: **Listener**
     
     - Frontend: Select **public** from drop-down list

     - Now select **Backend targets**

       ![bc](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/list.png?raw=true)
       
     - Under **Backend targets**, select Target type as **BackendPool(1)** and select **Add new** for HTTP Settings.

       ![http](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/attp.png?raw=true)
          
          - Under **Add a HTTP setting** page, enter **HTTP settings name** and click on **Add**

               ![http](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/http.png?raw=true)
               
      - Click on **Add** under **Add a routing table** page.

         ![page](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/rt.png?raw=true)
         
10. Click on **Next: Tags** from **Create application gateway** page.

11. Select **Review + Create**, from **Create application gateway**

      ![create](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/rc2.png?raw=true)
      
12. Review the configuration and select **Create**.

      ![create](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/create2.png?raw=true)
      
13. After successful deployment, click on **Home**.

      ![gotore](https://github.com/Divyasri199/AIW-Azure-Network-Solutions/blob/prod/media/home1.png?raw=true)

      
        
## Task 3: Publish Application via Azure Firewall & Application Gateway.             




